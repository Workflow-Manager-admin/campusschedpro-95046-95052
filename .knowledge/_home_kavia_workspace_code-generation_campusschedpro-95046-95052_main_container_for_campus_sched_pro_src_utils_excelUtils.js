{"is_source_file": true, "format": "JavaScript", "description": "This module provides utilities for generating Excel templates for courses, faculty, and rooms, as well as importing data from Excel files into a database via Supabase. It includes functions for creating download links for standardized templates and processing uploaded Excel files to populate database tables, including handling dependencies like departments and buildings.", "external_files": ["./supabaseClient", "xlsx", "uuid"], "external_methods": ["supabase.from", "XLSX.utils.aoa_to_sheet", "XLSX.utils.book_new", "XLSX.utils.book_append_sheet", "XLSX.writeFile", "XLSX.read", "XLSX.utils.sheet_to_json"], "published": ["generateCourseTemplate", "generateFacultyTemplate", "generateRoomTemplate", "importCoursesFromExcel", "importRoomsFromExcel", "importFacultyFromExcel"], "classes": [], "methods": [{"name": "createAndDownloadTemplate", "description": "Creates an Excel worksheet with headers and example data, then creates a workbook object, appends the worksheet, and triggers download as a file."}, {"name": "generateCourseTemplate", "description": "Defines headers and example data for a course template Excel file and initiates its download."}, {"name": "generateFacultyTemplate", "description": "Defines headers and example data for a faculty template Excel file and initiates its download."}, {"name": "generateRoomTemplate", "description": "Defines headers and example data for a room template Excel file and initiates its download."}, {"name": "readExcelFile", "description": "Reads an Excel file (File object), parses its first sheet, and returns its contents as an array of arrays."}, {"name": "getOrCreateDepartmentId", "description": "Fetches existing department ID by name or inserts a new department if not found."}, {"name": "importCoursesFromExcel", "description": "Imports course data from an uploaded Excel file, creating new courses and departments as needed, and returns success counts and errors."}, {"name": "getOrCreateBuildingId", "description": "Fetches existing building ID by name or inserts a new building if not found."}, {"name": "importRoomsFromExcel", "description": "Imports room data from an uploaded Excel file, creating new rooms and buildings as needed, and returns success counts and errors."}, {"name": "importFacultyFromExcel", "description": "Imports faculty data from an uploaded Excel file, creating new faculty, departments, and faculty expertise records, and returns success counts and errors."}], "search-terms": ["Excel templates", "import data", "supabase", "xlsx parsing", "department creation", "building creation", "course import", "faculty import", "room import"], "state": 2, "file_id": 103, "knowledge_revision": 453, "git_revision": "a6028f1924beb30244e33ebbd42d1a0b4d2c72fb", "revision_history": [{"361": "22b7e5982fd7cef2b6f6ef0e32d51615bffad930"}, {"389": "de660c5c0543ded224299293185aeea299543564"}, {"390": "de660c5c0543ded224299293185aeea299543564"}, {"435": "27294bf9b1c5fba691e62e6c4608e06782522ea3"}, {"436": "bab511b7742cbde271c73ea7eb16baff4833f355"}, {"437": "bab511b7742cbde271c73ea7eb16baff4833f355"}, {"439": "c6f39bf63a668445e6c69a9dc987aab41871def5"}, {"442": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"443": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"444": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"445": "249899bd712e50d11d4caf49b6aaa69653807d6c"}, {"446": "c5c5f2292934c0be03465e78773be947ccd0c201"}, {"447": "ddd0f86754792bb872bece2ea258d4182c4de3bf"}, {"448": "26b24c08b259553dd47ab2c52da1039239630f5b"}, {"449": "26b24c08b259553dd47ab2c52da1039239630f5b"}, {"450": "a43e516bfd3fae825486516e3ae50f8ee9df5817"}, {"453": "a6028f1924beb30244e33ebbd42d1a0b4d2c72fb"}], "ctags": [{"_type": "tag", "name": "building", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const building = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildingId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const buildingId = building ? await getOrCreateBuildingId(building) : null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "capacity", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const capacity = parseInt(row[3], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "code", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const code = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "createAndDownloadTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const createAndDownloadTemplate = (headers, exampleData, filename) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "credits", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const credits = parseInt(row[2], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const data = await readExcelFile(file);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "department", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const department = row[2];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "department", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const department = row[5];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "departmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const departmentId = department ? await getOrCreateDepartmentId(department) : null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const email = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const errors = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "exampleData", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const exampleData = [[$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expectedEnrollment", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const expectedEnrollment = parseInt(row[4], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expertise", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const expertise = row[3] ? String(row[3]).split(',').map(e => e.trim()) : [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expertiseRecords", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^          const expertiseRecords = expertise.map(item => ({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "facultyId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^          const facultyId = facultyData[0].id;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "floor", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const floor = row[4] || '1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateCourseTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateCourseTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateFacultyTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateFacultyTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateRoomTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateRoomTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrCreateBuildingId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const getOrCreateBuildingId = async (name) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrCreateDepartmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const getOrCreateDepartmentId = async (name) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const headers = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importCoursesFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importCoursesFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importFacultyFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importFacultyFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importRoomsFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importRoomsFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "instructor", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const instructor = row[3];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const name = row[0];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "readExcelFile", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const readExcelFile = (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "requiresLab", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const requiresLab = String(row[6] || '').toLowerCase() === 'yes';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "row", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      const row = data[i];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "successfulImports", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const successfulImports = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const type = row[2] || 'Classroom';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wb = XLSX.utils.book_new();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ws", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const ws = XLSX.utils.aoa_to_sheet([headers, ...exampleData]);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "hash": "8336f94f9c74c221bdb9babc7a9f5332", "format-version": 4, "code-base-name": "default"}