{"is_source_file": true, "format": "JavaScript", "description": "This file contains utility functions for handling Excel templates and data import/export related to courses, faculty, and rooms, integrating with a database via supabase, and using third-party libraries XLSX and FileSaver.", "external_files": ["./supabaseClient"], "external_methods": ["supabase.from", "XLSX.utils.aoa_to_sheet", "XLSX.write", "XLSX.read", "XLSX.utils.sheet_to_json"], "published": ["generateCourseTemplate", "generateFacultyTemplate", "generateRoomTemplate", "importCoursesFromExcel", "importRoomsFromExcel", "importFacultyFromExcel"], "classes": [], "methods": [{"name": "createAndDownloadTemplate", "description": "Creates an Excel file with specified headers and data, then triggers download via FileSaver.", "parameters": ["headers", "exampleData", "filename", "errorCallback"]}, {"name": "generateCourseTemplate", "description": "Generates and downloads a course template Excel file with predefined headers and example data."}, {"name": "generateFacultyTemplate", "description": "Generates and downloads a faculty template Excel file with predefined headers and example data."}, {"name": "generateRoomTemplate", "description": "Generates and downloads a room template Excel file with predefined headers and example data."}, {"name": "readExcelFile", "description": "Reads an Excel file and converts it into an array of arrays containing the sheet data."}, {"name": "importCoursesFromExcel", "description": "Parses an Excel file and imports course data into the database, creating new departments as needed."}, {"name": "getOrCreateDepartmentId", "description": "Retrieves existing department ID or creates a new department with the given name."}, {"name": "importRoomsFromExcel", "description": "Parses an Excel file and imports room data, creating buildings as needed."}, {"name": "getOrCreateBuildingId", "description": "Retrieves existing building ID or creates a new building with the given name."}, {"name": "importFacultyFromExcel", "description": "Parses an Excel file and imports faculty data, including expertise and department association."}], "calls": ["XLSX.utils.aoa_to_sheet", "XLSX.write", "XLSX.read", "XLSX.utils.sheet_to_json", "supabase.from('departments').select('id').eq('name', ...)", "supabase.from('departments').insert({ name })", "supabase.from('courses').insert({ ... })", "supabase.from('buildings').select('id').eq('name', ...)", "supabase.from('buildings').insert({ name })", "supabase.from('faculty').insert({ ... })", "supabase.from('faculty_expertise').insert(...)"], "search-terms": ["Excel template generator", "data import from Excel", "course import", "faculty import", "room import", "supabase integration", "Excel reading", "FileSaver download"], "state": 2, "file_id": 109, "knowledge_revision": 439, "git_revision": "83e3e59462746ff2cadeaf7aaa38efaa8e92f81a", "ctags": [{"_type": "tag", "name": "blob", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const blob = new Blob([wbout], { type: 'application\\/octet-stream' });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "building", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const building = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildingId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const buildingId = building ? await getOrCreateBuildingId(building) : null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "capacity", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const capacity = parseInt(row[3], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "code", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const code = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "createAndDownloadTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const createAndDownloadTemplate = (headers, exampleData, filename, errorCallback) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "credits", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const credits = parseInt(row[2], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const data = await readExcelFile(file);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "department", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const department = row[2];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "department", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const department = row[5];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "departmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const departmentId = department ? await getOrCreateDepartmentId(department) : null;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const email = row[1];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const errors = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "exampleData", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const exampleData = [[$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expectedEnrollment", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const expectedEnrollment = parseInt(row[4], 10) || 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expertise", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const expertise = row[3] ? String(row[3]).split(',').map(e => e.trim()) : [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "expertiseRecords", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^          const expertiseRecords = expertise.map(item => ({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "facultyId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^          const facultyId = facultyData[0].id;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "floor", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const floor = row[4] || '1';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateCourseTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateCourseTemplate = (errorCallback) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateFacultyTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateFacultyTemplate = (errorCallback) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateRoomTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateRoomTemplate = (errorCallback) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrCreateBuildingId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const getOrCreateBuildingId = async (name) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getOrCreateDepartmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const getOrCreateDepartmentId = async (name) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const headers = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importCoursesFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importCoursesFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importFacultyFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importFacultyFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importRoomsFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importRoomsFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "instructor", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const instructor = row[3];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const name = row[0];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "readExcelFile", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const readExcelFile = (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "requiresLab", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const requiresLab = String(row[6] || '').toLowerCase() === 'yes';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "row", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      const row = data[i];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "successfulImports", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const successfulImports = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const type = row[2] || 'Classroom';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const wb = XLSX.utils.book_new();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wbout", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ws", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const ws = XLSX.utils.aoa_to_sheet([headers, ...exampleData]);$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "hash": "1fa351ac00c9f30bee81fa7440b31979", "format-version": 4, "code-base-name": "default", "revision_history": [{"439": "83e3e59462746ff2cadeaf7aaa38efaa8e92f81a"}]}