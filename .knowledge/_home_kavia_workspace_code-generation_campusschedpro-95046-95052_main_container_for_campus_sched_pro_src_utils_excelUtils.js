{"is_source_file": true, "format": "JavaScript", "description": "This file provides utility functions for creating, downloading, and importing Excel files related to courses, rooms, and faculty data, including parsing Excel data, generating templates, and synchronizing data with a database via supabase.", "external_files": ["./supabaseClient"], "external_methods": ["supabase.from", "supabase.upsert", "supabase.delete", "supabase.insert", "supabase.select"], "published": ["generateCourseTemplate", "importCoursesFromExcel", "generateRoomTemplate", "importRoomsFromExcel", "generateFacultyTemplate", "importFacultyFromExcel"], "classes": [], "methods": [{"name": "createWorkbook", "description": "Creates an XLSX workbook object from data and column definitions."}, {"name": "downloadExcelFile", "description": "Triggers download of the given workbook as an Excel file."}, {"name": "generateCourseTemplate", "description": "Generates and downloads a course template Excel file."}, {"name": "importCoursesFromExcel", "description": "Reads and imports course data from an uploaded Excel file, processing and saving data to the database."}, {"name": "generateRoomTemplate", "description": "Generates and downloads a room template Excel file."}, {"name": "importRoomsFromExcel", "description": "Reads and imports room data from an uploaded Excel file, processing and saving data to the database."}, {"name": "generateFacultyTemplate", "description": "Generates and downloads a faculty template Excel file."}, {"name": "importFacultyFromExcel", "description": "Reads and imports faculty data from an uploaded Excel file, processing and saving data to the database, using an enhanced save helper."}, {"name": "readExcelFile", "description": "Reads an Excel file into an array of arrays representing rows and columns."}], "calls": ["XLSX.utils.aoa_to_sheet", "XLSX.utils.book_new", "XLSX.utils.book_append_sheet", "XLSX.writeFile", "XLSX.read", "XLSX.utils.sheet_to_json", "supabase.from", "supabase.upsert", "supabase.delete", "supabase.insert", "supabase.select", "getOrCreateDepartment", "getOrCreateAcademicYear", "getOrCreateBuilding", "getOrCreateEquipment", "enhancedSaveFaculty"], "search-terms": ["excelUtils", "generateCourseTemplate", "importCoursesFromExcel", "generateRoomTemplate", "importRoomsFromExcel", "generateFacultyTemplate", "importFacultyFromExcel", "supabase", "xlsx", "downloadExcelFile", "readExcelFile"], "state": 2, "file_id": 103, "knowledge_revision": 447, "git_revision": "ddd0f86754792bb872bece2ea258d4182c4de3bf", "revision_history": [{"361": "22b7e5982fd7cef2b6f6ef0e32d51615bffad930"}, {"389": "de660c5c0543ded224299293185aeea299543564"}, {"390": "de660c5c0543ded224299293185aeea299543564"}, {"435": "27294bf9b1c5fba691e62e6c4608e06782522ea3"}, {"436": "bab511b7742cbde271c73ea7eb16baff4833f355"}, {"437": "bab511b7742cbde271c73ea7eb16baff4833f355"}, {"439": "c6f39bf63a668445e6c69a9dc987aab41871def5"}, {"442": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"443": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"444": "08de21fdb1a8d9dcfdb6ad72d384dfee52188977"}, {"445": "249899bd712e50d11d4caf49b6aaa69653807d6c"}, {"446": "c5c5f2292934c0be03465e78773be947ccd0c201"}, {"447": "ddd0f86754792bb872bece2ea258d4182c4de3bf"}], "ctags": [{"_type": "tag", "name": "XLSX", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  XLSX = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "XLSX", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^let XLSX;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "academicYearId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const academicYearId = await getOrCreateAcademicYear(course.academicYear);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "allErrors", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const allErrors = [...errors, ...saveErrors];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "aoa_to_sheet", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      aoa_to_sheet: () => ({}),$/", "language": "JavaScript", "kind": "property", "scope": "XLSX.utils", "scopeKind": "class"}, {"_type": "tag", "name": "book_append_sheet", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      book_append_sheet: () => {},$/", "language": "JavaScript", "kind": "property", "scope": "XLSX.utils", "scopeKind": "class"}, {"_type": "tag", "name": "book_new", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      book_new: () => ({}),$/", "language": "JavaScript", "kind": "property", "scope": "XLSX.utils", "scopeKind": "class"}, {"_type": "tag", "name": "buildingId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const buildingId = await getOrCreateBuilding(room.building);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "columns", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const columns = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "createWorkbook", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const createWorkbook = (data, columns, sheetName) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "data", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const data = await readExcelFile(file);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "departmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const departmentId = await getOrCreateDepartment(course.department);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "downloadExcelFile", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const downloadExcelFile = (workbook, filename) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "equipmentId", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^              const equipmentId = await getOrCreateEquipment(item);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "errors", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const errors = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "exampleData", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const exampleData = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateCourseTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateCourseTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateFacultyTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateFacultyTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateRoomTemplate", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const generateRoomTemplate = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "headerRow", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const headerRow = columns.map(col => col.header);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importCoursesFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importCoursesFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importFacultyFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importFacultyFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importRoomsFromExcel", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^export const importRoomsFromExcel = async (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importedCourses", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const importedCourses = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importedFaculty", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const importedFaculty = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "importedRooms", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const importedRooms = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "read", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    read: () => ({ SheetNames: ['Sheet1'], Sheets: { Sheet1: {} } })$/", "language": "JavaScript", "kind": "property", "scope": "XLSX", "scopeKind": "class"}, {"_type": "tag", "name": "readExcelFile", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^const readExcelFile = (file) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^        const result = await enhancedSaveFaculty(faculty);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "rows", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const rows = data.slice(1);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "saveErrors", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    const saveErrors = [];$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sheet_to_json", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^      sheet_to_json: () => ([])$/", "language": "JavaScript", "kind": "property", "scope": "XLSX.utils", "scopeKind": "class"}, {"_type": "tag", "name": "successCount", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    let successCount = 0;$/", "language": "JavaScript", "kind": "variable"}, {"_type": "tag", "name": "utils", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    utils: {$/", "language": "JavaScript", "kind": "class", "scope": "XLSX", "scopeKind": "class"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wb = XLSX.utils.book_new();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wb = createWorkbook(exampleData, columns, 'Courses');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wb = createWorkbook(exampleData, columns, 'Faculty');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wb", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wb = createWorkbook(exampleData, columns, 'Rooms');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "writeFile", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^    writeFile: () => {},$/", "language": "JavaScript", "kind": "property", "scope": "XLSX", "scopeKind": "class"}, {"_type": "tag", "name": "ws", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const ws = XLSX.utils.aoa_to_sheet(wsData);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "wsData", "path": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "pattern": "/^  const wsData = [headerRow, ...data];$/", "language": "JavaScript", "kind": "constant"}], "filename": "/home/kavia/workspace/code-generation/campusschedpro-95046-95052/main_container_for_campus_sched_pro/src/utils/excelUtils.js", "hash": "3825ca6283c9a217caab1644057a4481", "format-version": 4, "code-base-name": "default", "fields": [{"name": "let XLSX;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "aoa_to_sheet: () => ({}),", "scope": "XLSX.utils", "scopeKind": "class", "description": "unavailable"}, {"name": "book_append_sheet: () => {},", "scope": "XLSX.utils", "scopeKind": "class", "description": "unavailable"}, {"name": "book_new: () => ({}),", "scope": "XLSX.utils", "scopeKind": "class", "description": "unavailable"}, {"name": "read: () => ({ SheetNames: ['Sheet1'], Sheets: { Sheet1: {} } })", "scope": "XLSX", "scopeKind": "class", "description": "unavailable"}, {"name": "sheet_to_json: () => ([])", "scope": "XLSX.utils", "scopeKind": "class", "description": "unavailable"}, {"name": "let successCount = 0;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "writeFile: () => {},", "scope": "XLSX", "scopeKind": "class", "description": "unavailable"}]}